Start testing: Nov 26 10:30 Pacific Standard Time
----------------------------------------------------------
1/2 Testing: platform_standalone
1/2 Test: platform_standalone
Command: "C:/Users/adamm/dev/nervosys/utilities/nccl/build_test/test_platform_standalone.exe"
Directory: C:/Users/adamm/dev/nervosys/utilities/nccl/build_test
"platform_standalone" start time: Nov 26 10:30 Pacific Standard Time
Output:
----------------------------------------------------------
========================================
NCCL Platform Abstraction Standalone Test
========================================

=== Platform Macros ===
  [PASS] NCCL_PLATFORM_WINDOWS is boolean
  [PASS] NCCL_PLATFORM_LINUX is boolean
  [PASS] Exactly one platform detected
  [INFO] Running on Windows
  [PASS] PATH_MAX is defined and positive
  [INFO] PATH_MAX = 260

=== Time Functions ===
  [PASS] clock_gettime(CLOCK_MONOTONIC) succeeds
  [PASS] tv_sec is non-negative
  [PASS] tv_nsec is valid
  [PASS] Time advances after sleep
  [PASS] At least 5ms elapsed
  [INFO] Elapsed: 17187900 ns

=== Thread Functions ===
  [PASS] pthread_mutex_init succeeds
  [PASS] pthread_mutex_lock succeeds
  [PASS] pthread_mutex_unlock succeeds
  [PASS] pthread_mutex_destroy succeeds
  [PASS] pthread_cond_init succeeds
  [PASS] pthread_cond_destroy succeeds
  [PASS] pthread_self returns valid handle

=== CPU Affinity ===
  [PASS] CPU_SETSIZE is positive
  [PASS] CPU_SETSIZE supports at least 64 CPUs
  [INFO] CPU_SETSIZE = 1024
  [PASS] CPU_ZERO creates empty set
  [PASS] CPU_SET sets bit correctly
  [PASS] CPU_COUNT returns 1
  [PASS] CPU_COUNT returns 3 after setting 3 CPUs
  [PASS] CPU_CLR clears bit correctly
  [PASS] CPU_COUNT returns 2 after clearing 1 CPU
  [PASS] sched_getaffinity succeeds
  [PASS] Process has at least one CPU in affinity
  [INFO] Process affinity has 24 CPUs

=== Socket Functions ===
  [PASS] WSAStartup succeeds
  [PASS] socket() succeeds
  [PASS] bind() to loopback succeeds
  [PASS] Port assigned by OS
  [INFO] Bound to port 49407
  [PASS] listen() succeeds
  [PASS] poll() times out correctly

=== Dynamic Loading ===
  [PASS] dlopen(kernel32.dll) succeeds
  [PASS] dlsym(GetCurrentProcessId) succeeds
  [PASS] dlopen of non-existent library fails
  [PASS] dlerror returns error message

=== Atomic Operations ===
  [PASS] Atomic store/load works
  [PASS] Atomic add works
  [PASS] Atomic sub works
  [PASS] CAS with correct expected succeeds
  [PASS] Value updated after CAS
  [PASS] Memory barriers don't crash

=== Miscellaneous ===
  [PASS] getpid returns positive value
  [INFO] PID = 12300
  [PASS] gettid returns positive value
  [INFO] TID = 36168
  [PASS] ncclGetNumProcessors returns positive value
  [INFO] Processors = 24
  [PASS] getenv(PATH) returns value

========================================
Results: 46 run, 46 passed, 0 failed
========================================
<end of output>
Test time =   0.04 sec
----------------------------------------------------------
Test Passed.
"platform_standalone" end time: Nov 26 10:30 Pacific Standard Time
"platform_standalone" time elapsed: 00:00:00
----------------------------------------------------------

2/2 Testing: platform_full
2/2 Test: platform_full
Command: "C:/Users/adamm/dev/nervosys/utilities/nccl/build_test/test_platform_full.exe"
Directory: C:/Users/adamm/dev/nervosys/utilities/nccl/build_test
"platform_full" start time: Nov 26 10:30 Pacific Standard Time
Output:
----------------------------------------------------------
========================================
NCCL Platform Abstraction Test Suite
========================================

=== Platform Detection Tests ===
  [PASS] Exactly one platform should be detected
  [PASS] NCCL_PLATFORM_WINDOWS should be 0 or 1
  [PASS] NCCL_PLATFORM_LINUX should be 0 or 1
  [PASS] NCCL_PLATFORM_POSIX should be 0 or 1
  [INFO] Detected platform: Windows
  [PASS] Windows platform detected correctly
  [PASS] Linux should not be detected on Windows
  [PASS] POSIX should not be detected on Windows
  [PASS] At most one compiler should be detected
  [INFO] Detected compiler: MSVC
  [PASS] PATH_MAX should be defined and positive
  [INFO] PATH_MAX = 260
  [PASS] ssize_t type should work correctly

=== Time Functions Tests ===
  [PASS] clock_gettime(CLOCK_MONOTONIC) should succeed
  [PASS] tv_sec should be non-negative
  [PASS] tv_nsec should be non-negative
  [PASS] tv_nsec should be less than 1 billion
  [PASS] Second clock_gettime should succeed
  [PASS] Time should advance after sleep
  [PASS] At least 5ms should have elapsed
  [INFO] Elapsed time: 16715100 ns
  [PASS] clock_gettime(CLOCK_REALTIME) should succeed
  [PASS] Real time seconds should be positive
  [INFO] Current time: 1764181815 seconds since epoch
  [PASS] clock_gettime with NULL should fail

=== Socket Abstraction Tests ===
  [PASS] Socket initialization should succeed
  [PASS] Socket creation should succeed
  [PASS] ioctlsocket for non-blocking should succeed
  [PASS] Bind to loopback should succeed
  [PASS] getsockname should succeed
  [PASS] Assigned port should be non-zero
  [INFO] Bound to port 49409
  [PASS] Listen should succeed
  [PASS] Poll should timeout with no connections
  [PASS] EINTR should be defined
  [PASS] EWOULDBLOCK should be defined
  [PASS] EINPROGRESS should be defined
  [PASS] Interface speed should be positive
  [INFO] Ethernet speed: 1000 Mbps

=== Thread Abstraction Tests ===
  [PASS] Mutex init should succeed
  [PASS] Cond init should succeed
  [PASS] Mutex lock should succeed
  [PASS] Mutex unlock should succeed
  [PASS] Thread create should succeed
  [PASS] Thread join should succeed
  [PASS] Thread should have incremented counter
  [PASS] Creating thread should succeed
  [PASS] Creating thread should succeed
  [PASS] Creating thread should succeed
  [PASS] Creating thread should succeed
  [PASS] Joining thread should succeed
  [PASS] Joining thread should succeed
  [PASS] Joining thread should succeed
  [PASS] Joining thread should succeed
  [PASS] Counter should equal threads * iterations (mutex protecting)
  [INFO] Counter after 4 threads x 1000 iterations: 4000
  [PASS] Trylock on unlocked mutex should succeed
  [INFO] Recursive trylock returned: 0
  [PASS] pthread_self should return valid handle
  [PASS] Cond destroy should succeed
  [PASS] Mutex destroy should succeed

=== CPU Affinity Tests ===
  [PASS] CPU_SETSIZE should be positive
  [PASS] CPU_SETSIZE should support at least 64 CPUs
  [INFO] CPU_SETSIZE = 1024
  [PASS] CPU_ZERO should create empty set
  [PASS] CPU 0 should be set after CPU_SET
  [PASS] Set should have 1 CPU after setting CPU 0
  [PASS] CPU 1 should be set
  [PASS] CPU 3 should be set
  [PASS] CPU 2 should not be set
  [PASS] Set should have 3 CPUs
  [PASS] CPU 1 should be cleared after CPU_CLR
  [PASS] Set should have 2 CPUs after clearing CPU 1
  [PASS] CPU 0 should be in set2
  [PASS] CPU 3 should be in set2
  [PASS] Sets with same CPUs should be equal
  [PASS] CPU 0 should not be in AND result
  [PASS] CPU 1 should be in AND result
  [PASS] CPU 2 should be in AND result
  [PASS] CPU 3 should not be in AND result
  [PASS] CPU 0 should be in OR result
  [PASS] CPU 1 should be in OR result
  [PASS] CPU 2 should be in OR result
  [PASS] CPU 3 should be in OR result
  [PASS] sched_getaffinity should succeed
  [PASS] Process should have at least one CPU in affinity mask
  [INFO] Process affinity has 24 CPUs
  [INFO] CPUs in affinity mask: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ... (8 more)
  [PASS] ncclGetNumProcessors should return positive value
  [INFO] System has 24 processors
  [INFO] Successfully set affinity to CPU 0
  [PASS] Restoring original affinity should succeed

=== Miscellaneous Functions Tests ===
  [PASS] getpid should return positive process ID
  [INFO] Current process ID: 13880
  [PASS] gettid should return positive thread ID
  [INFO] Current thread ID: 34944
  [PASS] Setting environment variable should succeed
  [PASS] getenv should find the variable
  [PASS] getenv should return correct value
  [INFO] Environment variable NCCL_TEST_ENV_VAR = test_value_12345
  [PASS] After unset, env var should be NULL or empty
  [INFO] NCCL_DEBUG not set
  [PASS] dlopen kernel32.dll should succeed
  [PASS] dlsym GetCurrentProcessId should succeed
  [PASS] dlclose should succeed
  [PASS] dlopen non-existent library should fail
  [PASS] dlerror should return error message
  [INFO] dlerror for non-existent library: LoadLibrary failed with error 126
  [PASS] Atomic store/load should work
  [PASS] Atomic add should work
  [PASS] Atomic sub should work
  [PASS] CAS with correct expected value should succeed
  [PASS] Value should be updated after successful CAS
  [PASS] Memory barriers should not crash
  [INFO] Atomic operations test completed successfully

========================================
Test Summary: 0 run, 0 passed, 0 failed
========================================
<end of output>
Test time =   0.05 sec
----------------------------------------------------------
Test Passed.
"platform_full" end time: Nov 26 10:30 Pacific Standard Time
"platform_full" time elapsed: 00:00:00
----------------------------------------------------------

End testing: Nov 26 10:30 Pacific Standard Time
